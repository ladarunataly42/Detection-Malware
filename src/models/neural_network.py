from sklearn.model_selection import train_test_split
from sklearn.neural_network import MLPClassifier

from src.basemodel import BaseModel


class NeuralNetwork(BaseModel):
    def __init__(self, model_name, activation='relu', learning_rate='constant'):
        super().__init__(model_name)
        self.__clf = MLPClassifier(activation=activation, learning_rate=learning_rate)

    def test_model(self):
        X_train, X_test, y_train, y_test = train_test_split(self._x, self._y, test_size=0.2, random_state=1,
                                                            shuffle=True)
        X_train, X_val, y_train, y_val = train_test_split(X_train, y_train, test_size=0.25, random_state=1,
                                                          shuffle=True)
        self.__clf.fit(X_train, y_train)
        self.val_score = self.__clf.score(X_val, y_val)
        self.test_score = self.__clf.score(X_test, y_test)
        self.print_model_score()
